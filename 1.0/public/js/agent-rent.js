function getPrice(e,t){if("53"==e.id||"54"==e.id||"55"==e.id||"56"==e.id||"57"==e.id||"58"==e.id)return $(e).notify("No service",{position:"right middle",autoHideDelay:2e3}),!1;console.log("click: "+e.id.charAt(0));var r=e.id.charAt(0),n="0";if("1 hour"==$("#rent_duration").val()?n="0":"2 hours"==$("#rent_duration").val()?n="1":"3 hours"==$("#rent_duration").val()?n="2":"5 hours"==$("#rent_duration").val()?n="3":"All Day (8am-8pm)"==$("#rent_duration").val()?n="4":"24 hours"==$("#rent_duration").val()&&(n="5"),r!=n)return $(e).notify("Please choose hours first",{position:"right middle",autoHideDelay:2e3}),!1;for(j=0;j<=5;j++)for(i=0;i<=bikes.length;i++){a="#"+j+i;$(a).css("background-color","white")}for(i=0;i<=bikes.length;i++){var a="#"+r+i;$(a).css("background-color","#rgb(232, 232, 232);")}var o=t+"_bike";$(o).val()<=19&&$(o).val(parseInt($(o).val())+1),calculate()}function goBack(){var e=0,t=document.getElementById("payment-form");for("1 hour"==t.elements.rent_duration.value?e=0:"2 hours"==t.elements.rent_duration.value?e=1:"3 hours"==t.elements.rent_duration.value?e=2:"5 hours"==t.elements.rent_duration.value?e=3:"All Day (8am-8pm)"==t.elements.rent_duration.value?e=4:"24 hours"==t.elements.rent_duration.value&&(e=5),j=0;j<=5;j++)for(i=0;i<=bikes.length;i++){r="#"+j+i;$(r).css("background-color","white")}for(i=0;i<=bikes.length;i++){var r="#"+e+i;$(r).css("background-color","#rgb(232, 232, 232)")}}function calculate(){var e=0,t=document.getElementById("payment-form");"1 hour"==t.elements.rent_duration.value?e=0:"2 hours"==t.elements.rent_duration.value?e=1:"3 hours"==t.elements.rent_duration.value?e=2:"5 hours"==t.elements.rent_duration.value?e=3:"All Day (8am-8pm)"==t.elements.rent_duration.value?e=4:"24 hours"==t.elements.rent_duration.value&&(e=5,$("#tandem_bike").val(0),$("#road_bike").val(0),$("#mountain_bike").val(0));var r=0,n=0,a=0;for(i=1;i<=bikes_arr.length;i++)r+=parseInt($(bikes[i-1]).val()*$("#"+e+i).val());for(i=1;i<=bikes_arr.length-1;i++)n+=parseInt($(bikes[i-1]).val());for(i=3;i<6;i++)a+=parseInt($(bikes[i-1]).val());for(1==$("#dropoff").prop("checked")&&(r+=5*n),1==$("#member_guest_checkbox").prop("checked")?$("#member_type").val().length>=1&&(r=(.5*r).toFixed(2)):1==$("#member_checkbox").prop("checked")?(n>1&&$("#adult_bike_label").notify("Membership only Applies for 1 Bike",{position:"top right"}),"Month Pass/$45"==$("#member_type").val()||"Annual Pass/$129"==$("#member_type").val()?r=3:$("#member_type").val()):1==$("#coupon_bike").prop("checked")&&(r=0,1==$("#dropoff").prop("checked")&&(r+=5*n),1==$("#insurance").prop("checked")&&(r+=2*(n-a),r+=4*a)),i=7;i<=bikes.length;i++)r+=parseInt($(bikes[i-1]).val()*$("#"+e+i).val());if(0==$("#coupon_bike").prop("checked")&&1==$("#insurance").prop("checked")&&(r+=2*(n-a),r+=4*a),r-=originalPriceBefore,totalsum=(r*tax).toFixed(2),numOrPercent&&$("#rent_adjust").val().length>=1&&(r=parseFloat($("#rent_adjust").val()),1==$("#dropoff").prop("checked")&&(r+=5*n),1==$("#insurance").prop("checked")&&(r+=2*(n-a),r+=4*a),r+=parseFloat($("#basket_bike").val())),numOrPercent||$("#rent_discount").val().trim().length>=1&&(1==$("#dropoff").prop("checked")&&(r-=5*n),1==$("#insurance").prop("checked")&&(r-=2*(n-a),r-=4*a),r-=parseFloat($("#basket_bike").val()),r*=1-.01*parseFloat($("#rent_discount").val()),$("#rent_adjust").val(r.toFixed(2)),1==$("#dropoff").prop("checked")&&(r+=5*n),1==$("#insurance").prop("checked")&&(r+=2*(n-a),r+=4*a),r+=parseFloat($("#basket_bike").val())),total_bikeNum=n,$("#rent_total_label").val((1*r).toFixed(2)).css("color","green"),1==$("#coupon_bike").prop("checked")?($("#rent_tax").val((0).toFixed(2)).css("color","green"),$("#rent_total_after_tax").val((1*r).toFixed(2)).css("color","green")):($("#rent_tax").val((.08875*r).toFixed(2)).css("color","green"),$("#rent_total_after_tax").val((r*tax).toFixed(2)).css("color","green")),$("#rent_deposit").val())o=parseFloat($("#rent_deposit").val());else var o=0;$("#rent_total_after_tax_deposit").val((parseFloat($("#rent_total_after_tax").val())+o).toFixed(2)).css("color","green"),r<0?($("#rent_rendered").val(0),$("#rent_change").val((r*tax*-1).toFixed(2))):($("#deposit_cash_checkbox").prop("checked"),$("#rent_change").val(null))}function ccSubmitCheck(){if(!checkName())return!1;if(!checkBikeNum())return!1;if(!checkValid())return!1;if(!checkMembership())return!1;if(!checkMembershipExpire())return!1;if(!checkDeposit())return!1;removeDisable();var e=/^(0\.[1-9]|[1-9][0-9]{0,2}(\.[0-9]{0,2})?)$/;return!!$("#rent_total_label").val().match(e)||($("#rent_total_label").notify("Please input valid price",{position:"right middle"}),!1)}function cashSubmitCheck(){if(!checkName())return!1;if(!checkBikeNum())return!1;if(!checkValid())return!1;if(!checkMembership())return!1;if(!checkRenderedCash())return!1;if(!checkMembershipExpire())return!1;if(!checkDeposit())return!1;removeDisable();return!0}function checkName(){return $("#rent_customer").val().trim().length<=0?($("#rent_customer").notify("Please input valid name",{position:"bottom center"}),!1):!($("#rent_customer_last").val().trim().length<=0)||($("#rent_customer_last").notify("Please input valid name",{position:"bottom center"}),!1)}function checkBikeNum(){return 0!=$("#adult_bike").val()||0!=$("#child_bike").val()||0!=$("#tandem_bike").val()||0!=$("#road_bike").val()||0!=$("#mountain_bike").val()||($("#adult_bike_label").notify("Bike number can't be 0",{position:"top center"}),!1)}function checkValid(){var e=/^\d+$/,t=/^\d{2}[/]\d{2}[/]\d{4}$/,r=/^-?\d*(\.\d+)?$/;return $("#adult_bike").val().match(e)&&$("#child_bike").val().match(e)&&$("#tandem_bike").val().match(e)&&$("#road_bike").val().match(e)&&$("#mountain_bike").val().match(e)&&$("#trailer_bike").val().match(e)&&$("#seat_bike").val().match(e)?$("#rent_date").val().match(t)?$("#rent_adjust").val().match(r)?!!$("#rent_rendered").val().match(r)||($("#rent_rendered").notify("Please input valid number",{position:"top right"}),!1):($("#rent_adjust").notify("Please input valid number",{position:"top right"}),!1):($("#rent_date_label").notify("Please input valid date",{position:"top right"}),!1):($("#adult_bike").notify("Please input valid number",{position:"top right"}),!1)}function clearMember(){$("#member_type").val(null),$("#rent_membership_expire").val(null),1==$("#member_checkbox").prop("checked")&&($("#rent_customer").val(null),$("#rent_customer_last").val(null),$("#rent_email").val(null))}function memberSearch(){return console.log("search"),clearMember(),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:"/bigbike/agent/rent/membership",data:{rent_membership:$("#rent_membership").val()},type:"POST",datatype:"JSON",success:function(e){var t=JSON.parse(e);"0"==t.order_completed&&$("#member_type").notify("Membership Fee hasn't paid yet",{position:"top right"}),console.log("response: "+typeof t.customer_name),1==$("#member_checkbox").prop("checked")&&($("#rent_customer").val(t.customer_name),$("#rent_customer_last").val(t.customer_lastname),$("#rent_email").val(t.customer_email)),$("#rent_membership_expire").val(t.enddate),$("#member_type").val(t.member_type);var r=t.enddate.split("-"),n=new Date(r[0],r[1]-1,r[2]);n.setDate(n.getDate()+1),n<new Date&&$("#rent_membership_expire").notify("Membership has been expired",{position:"top right"}),calculate()},error:function(e){$("#rent_customer").val("No such member!")}}),!1}function checkMembership(){return!(1==$("#member_checkbox").prop("checked")&&total_bikeNum>1)||($("#adult_bike_label").notify("Membership only Applies for 1 Bike",{position:"top right"}),!1)}function checkRenderedCash(){if($("#rent_adjust").val().length>0);else if($("#rent_deposit").val())if(1==$("#deposit_cash_checkbox").prop("checked"));else if(1==$("#deposit_cc_checkbox").prop("checked")&&parseFloat($("#rent_total_after_tax").val())>parseFloat($("#rent_rendered").val()))return $("#rent_rendered").notify("Cash is not enough",{position:"top right"}),console.log("NEW THIS"),!1;return!0}function checkDeposit(){if($("#rent_deposit").val().length<=0)return $("#rent_deposit").notify("Deposit",{position:"top right"}),!1}function checkMembershipExpire(){if(1==$("#member_checkbox").prop("checked")||1==$("#member_guest_checkbox").prop("checked")){var e=new Date,t=new Date($("#rent_membership_expire").val());if(t.setDate(t.getDate()+1),console.log("end: "+t),t<e)return $("#rent_membership_expire").notify("Membership has been expired",{position:"top right"}),!1}return!0}function removeDisable(){$("#member_type").prop("disabled",!1)}function checkDeposit(){return!$("#rent_deposit").val()||1==$("#deposit_cc_checkbox").prop("checked")||1==$("#deposit_cash_checkbox").prop("checked")||($("#rent_deposit").notify("Select a payment method",{position:"top right"}),!1)}function checkDepositCCwithCash(){if($("#rent_deposit").val()&&1==$("#deposit_cc_checkbox").prop("checked")){if($("#rent_rendered").val().length<=0)return $("#rent_rendered").notify("Cash is not enough",{position:"top right"}),console.log("THIS ONE"),!1;if($("#rent_adjust").val().length>0){if(parseFloat($("#rent_adjust").val())>parseFloat($("#rent_rendered").val()))return $("#rent_rendered").notify("Cash is not enough",{position:"top right"}),console.log("THIS TWO"),!1}else if(parseFloat($("#rent_total_after_tax").val())>parseFloat($("#rent_rendered").val()))return $("#rent_rendered").notify("Cash is not enough",{position:"top right"}),console.log("not enough"),console.log("THIS 3"),!1}return!1}$(function(){for($(".field").keyup(function(){calculate()}),$(".ui-spinner-button").click(function(){calculate()}),$("#basket").click(function(){calculate()}),$("#insurance").click(function(){calculate()}),$("#dropoff").click(function(){calculate()}),i=0;i<=bikes.length;i++){var e="#0"+i;$(e).css("background-color","#rgb(232, 232, 232);")}$(".duration-title").click(function(){$("#rent_duration").val(this.value);var e=this.id.charAt(0);for(j=0;j<=5;j++)for(i=0;i<=bikes.length;i++){t="#"+j+i;$(t).css("background-color","white")}for(i=0;i<=bikes.length;i++){var t="#"+e+i;$(t).css("background-color","#rgb(232, 232, 232)")}calculate()}),$(".rent_duration").change(function(){for(console.log("Handler for .change() called."),j=0;j<=5;j++)for(i=0;i<=bikes.length;i++){r="#"+j+i;$(r).css("background-color","white")}var e="0",t=document.getElementById("payment-form");for("1 hour"==t.elements.rent_duration.value?e="0":"2 hours"==t.elements.rent_duration.value?e="1":"3 hours"==t.elements.rent_duration.value?e="2":"5 hours"==t.elements.rent_duration.value?e="3":"All Day (8am-8pm)"==t.elements.rent_duration.value?e="4":"24 hours"==t.elements.rent_duration.value&&(e="5",$("#tandem_bike").val(0),$("#road_bike").val(0),$("#mountain_bike").val(0)),i=0;i<=bikes.length;i++){var r="#"+e+i;$(r).css("background-color","#rgb(232, 232, 232)")}calculate()}),$("#cash_paid_label").keyup(function(){var e=parseFloat($("#cash_paid_label").val()),t=parseFloat($("#tips_label").val());e>=t?(console.log("true"),$("#rent_cash_change_label").val((e-t).toFixed(2)).css("color","green")):console.log("false")}),goBack(),$("#rent_adjust").keyup(function(){if(numOrPercent=!0,$("#rent_adjust").val()){var e=totalsum/tax;0!=totalsum&&$("#rent_discount").val((100*(1-parseFloat($("#rent_adjust").val())/parseFloat(e))).toFixed(0)),0==parseFloat($("#rent_discount").val())&&$("#rent_discount").val(0),$("#rent_total_label").val($("#rent_adjust").val())}else $("#rent_discount").val(null);calculate()}),$("#rent_discount").keyup(function(){if(numOrPercent=!1,$("#rent_discount").val()){var e=0,t=0;for(i=1;i<=bikes_arr.length-1;i++)e+=parseInt($(bikes[i-1]).val());for(i=3;i<6;i++)t+=parseInt($(bikes[i-1]).val());var r=totalsum/tax;1==$("#dropoff").prop("checked")&&(r-=5*e),1==$("#insurance").prop("checked")&&(r-=2*(e-t),r-=4*t);var n=r-=parseFloat($("#basket_bike").val());$("#rent_adjust").val(((1-parseFloat($("#rent_discount").val())/100)*parseFloat(n)).toFixed(2))}else $("#rent_adjust").val(null);calculate()}),$("#rent_rendered").focus(function(){"0"==$("#rent_rendered").val()&&$("#rent_rendered").val(null)}),$("#rent_rendered").keyup(function(){if($("#rent_rendered").val())if(1==$("#deposit_cc_checkbox").prop("checked"))console.log("cc checked"),(e=parseFloat($("#rent_rendered").val()))>=(t=parseFloat($("#rent_total_after_tax").val()))?$("#rent_change").val((e-t).toFixed(2)):$("#rent_change").val(null);else{var e=parseFloat($("#rent_rendered").val()),t=parseFloat($("#rent_total_after_tax_deposit").val());e>=t?$("#rent_change").val((e-t).toFixed(2)):$("#rent_change").val(null)}else $("#rent_change").val(null)}),$("#rent_rendered").focus(function(){"0"==$("#rent_rendered").val()&&$("#rent_rendered").val(null)}),$("#rent_rendered").blur(function(){null!=$("#rent_rendered").val()&&0!=$("#rent_rendered").val().length||$("#rent_rendered").val(0)}),$("#member_checkbox").change(function(){1==$(this).prop("checked")?($("#member_guest_checkbox").prop("checked",!1),$(".member_checkbox_label").css("display","inline-block")):$(".member_checkbox_label").css("display","none"),calculate()}),$("#member_guest_checkbox").change(function(){1==$(this).prop("checked")?($("#member_checkbox").prop("checked",!1),$(".member_checkbox_label").css("display","inline-block"),$("#coupon_bike").prop("checked",!1)):$(".member_checkbox_label").css("display","none"),calculate()}),$("#coupon_bike").change(function(){1==$(this).prop("checked")&&($("#member_checkbox").prop("checked",!1),$("#member_guest_checkbox").prop("checked",!1),$(".member_checkbox_label").css("display","none")),calculate()}),$("#rent_agent").autocomplete({source:agentList}),$("#rent_agent").focus(function(){" "==this.value&&(this.value="")}),$(".field").focus(function(){" "==this.value&&(this.value="")}),$("#rent_deposit").keyup(function(){console.log("click"),$("#rent_deposit").val()?calculate():(calculate(),$("#rent_deposit").val(null))}),$("#deposit_cc_checkbox").change(function(){1==$(this).prop("checked")&&$("#deposit_cash_checkbox").prop("checked",!1)}),$("#deposit_cash_checkbox").change(function(){1==$(this).prop("checked")&&$("#deposit_cc_checkbox").prop("checked",!1),calculate(),console.log("cash_checkbox")}),$('[name="cash"]').click(function(){$("form").attr("target","_self")}),$(".bike").focus(function(){"0"==$(this).val()&&$(this).val(null)})});var bikes=["#adult_bike","#child_bike","#tandem_bike","#road_bike","#mountain_bike","#trailer_bike","#basket_bike","#seat_bike"],bikes_arr=["#adult_bike","#child_bike","#tandem_bike","#road_bike","#mountain_bike","#trailer_bike"],totalsum,total_bikeNum,tax=1.08875,numOrPercent=!1;